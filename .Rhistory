bg = "red", col = "red", lwd = 1.25, cex = 2)
# Add error bars
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean + dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean - dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean + dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean - dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
# Add ticks
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at = c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("-1", "0", "1", "2"), at = c(-1, 0, 1, 2))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(-11, 0, 1, 2), labels = F)
# Add horizontal line
abline(h = 1, col= "darkgray", lty = 2, lwd = 2)
# Add axis labels
mtext(expression('Strains'), side = 1,
outer = TRUE, cex = 1.5, line = -2.5, adj = 0.5)
mtext(expression('dN/dS'), side = 2,
outer = TRUE, cex = 1.5, line = -3, adj = 0.6)
# Add legend
legend(0.1, 205, legend=c("no longevity", "longevity"),
col=c("blue", "red"), pt.bg = c("blue", "red"),
pch = c(22, 22), pt.cex = 1.5, cex = 0.75, bty = "n")
# Add strain labels
text(x=0.38, y=-0.9,"wild type",srt = 60, xpd = NA, cex = 1)
text(x=2.4, y= -0.8, expression(paste("rpl10a",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=4.4, y= -0.8, expression(paste("pmr1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=6.4, y= -0.8, expression(paste("sch9",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=8.4, y= -0.8, expression(paste("ypt6",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=10.4, y= -0.8, expression(paste("tor1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=12.4, y= -0.8, expression(paste("tif2",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=14.4, y= -0.8, "LYS2", srt = 60, xpd = NA, cex = 1)
# Close plot device
dev.off()
graphics.off()
# Show plot
img <- readPNG("~/GitHub/XevoLong/figures/Fig6.png")
grid.raster(img)
```
# Stats
```{r}
fit <- aov(dnds ~ strain * treat, data = dat)
summary(fit)
# Effect of longevity treatment: 44% increase in dN/dS
long.effect <- dat %>%
group_by(treat) %>%
dplyr::summarise(mean = mean(dnds), sem = sem(dnds))
# Effect of strains: wild type one of the highest (118) along with tif2 (123);
# Others were lower (~93-99) with tor1 (78) having fewest mutations
# Seems aging mutants have reduced mutations
# Test with contrasts?
strain.effect <- dat %>%
group_by(strain) %>%
dplyr::summarise(mean = mean(dnds), sem = sem(dnds))
png(filename="~/GitHub/XevoLong/figures/Fig6.png",
width = 1200, height = 900, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(jitter(x.ind, amount = 0.5), dnds.NL.ind$dnds, xlim = c(0, 16),
ylim = c(-0.2, 2.5), type = "p", pch = 22, bg = "lightblue",
col = "lightblue", cex = 0.75, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n")
box(lwd = 2)
points(jitter(x.ind, amount = 0.5), dnds.L.ind$t.sum,
pch = 22, bg = "pink", col = "pink", lwd = 2, cex = 0.75)
# Add means
points(x, dnds.NL$mean, pch = 22,
bg = "blue", col = "blue", lwd = 1.25, cex = 2)
points(x, dnds.L$mean, pch = 22,
bg = "red", col = "red", lwd = 1.25, cex = 2)
# Add error bars
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean + dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean - dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean + dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean - dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
# Add ticks
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at = c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("-1", "0", "1", "2"), at = c(-1, 0, 1, 2))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(-11, 0, 1, 2), labels = F)
# Add horizontal line
abline(h = 1, col= "darkgray", lty = 2, lwd = 2)
# Add axis labels
mtext(expression('Strains'), side = 1,
outer = TRUE, cex = 1.5, line = -2.5, adj = 0.5)
mtext(expression('dN/dS'), side = 2,
outer = TRUE, cex = 1.5, line = -4, adj = 0.5)
# Add legend
legend(0.1, 205, legend=c("no longevity", "longevity"),
col=c("blue", "red"), pt.bg = c("blue", "red"),
pch = c(22, 22), pt.cex = 1.5, cex = 0.75, bty = "n")
# Add strain labels
text(x=0.38, y=-0.9,"wild type",srt = 60, xpd = NA, cex = 1)
text(x=2.4, y= -0.8, expression(paste("rpl10a",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=4.4, y= -0.8, expression(paste("pmr1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=6.4, y= -0.8, expression(paste("sch9",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=8.4, y= -0.8, expression(paste("ypt6",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=10.4, y= -0.8, expression(paste("tor1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=12.4, y= -0.8, expression(paste("tif2",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=14.4, y= -0.8, "LYS2", srt = 60, xpd = NA, cex = 1)
# Close plot device
dev.off()
graphics.off()
# Show plot
img <- readPNG("~/GitHub/XevoLong/figures/Fig6.png")
grid.raster(img)
png(filename="~/GitHub/XevoLong/figures/Fig6.png",
width = 1200, height = 900, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(jitter(x.ind, amount = 0.5), dnds.NL.ind$dnds, xlim = c(0, 16),
ylim = c(-0.2, 2.5), type = "p", pch = 22, bg = "lightblue",
col = "lightblue", cex = 0.75, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n")
box(lwd = 2)
points(jitter(x.ind, amount = 0.5), dnds.L.ind$t.sum,
pch = 22, bg = "pink", col = "pink", lwd = 2, cex = 0.75)
# Add means
points(x, dnds.NL$mean, pch = 22,
bg = "blue", col = "blue", lwd = 1.25, cex = 2)
points(x, dnds.L$mean, pch = 22,
bg = "red", col = "red", lwd = 1.25, cex = 2)
# Add error bars
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean + dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean - dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean + dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean - dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
# Add ticks
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at = c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("-1", "0", "1", "2"), at = c(-1, 0, 1, 2))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(-11, 0, 1, 2), labels = F)
# Add horizontal line
abline(h = 1, col= "darkgray", lty = 2, lwd = 2)
# Add axis labels
mtext(expression('Strains'), side = 1,
outer = TRUE, cex = 1.5, line = -2.5, adj = 0.5)
mtext(expression('dN/dS'), side = 2,
outer = TRUE, cex = 1.5, line = -4, adj = 0.55)
# Add legend
legend(0.1, 205, legend=c("no longevity", "longevity"),
col=c("blue", "red"), pt.bg = c("blue", "red"),
pch = c(22, 22), pt.cex = 1.5, cex = 0.75, bty = "n")
# Add strain labels
text(x=0.38, y=-0.9,"wild type",srt = 60, xpd = NA, cex = 1)
text(x=2.4, y= -0.8, expression(paste("rpl10a",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=4.4, y= -0.8, expression(paste("pmr1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=6.4, y= -0.8, expression(paste("sch9",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=8.4, y= -0.8, expression(paste("ypt6",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=10.4, y= -0.8, expression(paste("tor1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=12.4, y= -0.8, expression(paste("tif2",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=14.4, y= -0.8, "LYS2", srt = 60, xpd = NA, cex = 1)
# Close plot device
dev.off()
graphics.off()
# Show plot
img <- readPNG("~/GitHub/XevoLong/figures/Fig6.png")
grid.raster(img)
summary(fit)
long.effect
dnds.NL
count(dnds.NL)
CL <- function(x) qt(0.975,df=count(x)-1)*sd(x)/sqrt(count(x))
dnds.NL.ind <- filter(dat, treat == c("NL"))
dnds.NL <- dnds.NL.ind %>%
group_by(treat, strain = fct_inorder(strain)) %>%
dplyr::summarise(mean = mean(dnds), sem = sem(dnds), CL = CL(dnds))
v <- c(2,3,4,9)
count(v)
lenght(v)
length(v)
CL <- function(x) qt(0.975,df=length(x)-1)*sd(x)/sqrt(length(x))
dnds.NL.ind <- filter(dat, treat == c("NL"))
dnds.NL <- dnds.NL.ind %>%
group_by(treat, strain = fct_inorder(strain)) %>%
dplyr::summarise(mean = mean(dnds), sem = sem(dnds), CL = CL(dnds))
dnds.NL
dnds.L.ind <- filter(dat, treat == c("L"))
dnds.L <- dnds.L.ind %>%
group_by(treat, strain = fct_inorder(strain)) %>%
dplyr::summarise(mean = mean(dnds), sem = sem(dnds), CL = CL(dnds))
png(filename="~/GitHub/XevoLong/figures/Fig6.png",
width = 1200, height = 900, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(jitter(x.ind, amount = 0.5), dnds.NL.ind$dnds, xlim = c(0, 16),
ylim = c(-0.2, 2.5), type = "p", pch = 22, bg = "lightblue",
col = "lightblue", cex = 0.75, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n")
box(lwd = 2)
points(jitter(x.ind, amount = 0.5), dnds.L.ind$t.sum,
pch = 22, bg = "pink", col = "pink", lwd = 2, cex = 0.75)
# Add means
points(x, dnds.NL$mean, pch = 22,
bg = "blue", col = "blue", lwd = 1.25, cex = 2)
points(x, dnds.L$mean, pch = 22,
bg = "red", col = "red", lwd = 1.25, cex = 2)
# Add error bars
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean + dnds.NL$CL,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean - dnds.NL$CL,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean + dnds.L$CL,
angle = 90, length = 0.1, lwd = 2, col = "red")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean - dnds.L$CL,
angle = 90, length = 0.1, lwd = 2, col = "red")
# Add ticks
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at = c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("-1", "0", "1", "2"), at = c(-1, 0, 1, 2))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(-11, 0, 1, 2), labels = F)
# Add horizontal line
abline(h = 1, col= "darkgray", lty = 2, lwd = 2)
# Add axis labels
mtext(expression('Strains'), side = 1,
outer = TRUE, cex = 1.5, line = -2.5, adj = 0.5)
mtext(expression('dN/dS'), side = 2,
outer = TRUE, cex = 1.5, line = -4, adj = 0.55)
# Add legend
legend(0.1, 205, legend=c("no longevity", "longevity"),
col=c("blue", "red"), pt.bg = c("blue", "red"),
pch = c(22, 22), pt.cex = 1.5, cex = 0.75, bty = "n")
# Add strain labels
text(x=0.38, y=-0.9,"wild type",srt = 60, xpd = NA, cex = 1)
text(x=2.4, y= -0.8, expression(paste("rpl10a",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=4.4, y= -0.8, expression(paste("pmr1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=6.4, y= -0.8, expression(paste("sch9",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=8.4, y= -0.8, expression(paste("ypt6",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=10.4, y= -0.8, expression(paste("tor1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=12.4, y= -0.8, expression(paste("tif2",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=14.4, y= -0.8, "LYS2", srt = 60, xpd = NA, cex = 1)
# Close plot device
dev.off()
graphics.off()
# Show plot
img <- readPNG("~/GitHub/XevoLong/figures/Fig6.png")
grid.raster(img)
dnds.L.ind
dnds.L
t.test(v, mu = 0, alternative = "two.sided")
dnds.L <- dnds.L.ind %>%
group_by(treat, strain = fct_inorder(strain)) %>%
dplyr::summarise(ttest = t.test(dnds, mu = 0, alternative = "two.sided"))
library(broom)
set.seed(354654)
d = tibble(value = rnorm(100),
category = sample(1:5, replace = TRUE, 100),
group = sample(c('A', 'B'), replace = TRUE, 100)) %>%
arrange(category)
d %>%
group_by(category, group) %>%
nest() %>%
spread(key = group, value = data) %>%
mutate(
t_test = map2(A, B, ~{t.test(.x$value, .y$value) %>% tidy()}),
A = map(A, nrow),
B = map(B, nrow)
) %>%
unnest()
tt <- dnds.L.ind %>%
group_by(strain) %>%
nest() %>%
spread(key = strain, value = data) %>%
mutate(
t_test = map2(A, B, ~{t.test(.x$value, .y$value) %>% tidy()}),
A = map(A, nrow),
B = map(B, nrow)
) %>%
unnest()
d = tibble(value = rnorm(100),
category = sample(1:5, replace = TRUE, 100),
group = sample(c('A', 'B'), replace = TRUE, 100)) %>%
arrange(category)
d
d = tibble(value = rnorm(10),
category = sample(1:5, replace = TRUE, 100),
group = sample(c('A', 'B'), replace = TRUE, 100)) %>%
arrange(category)
d = tibble(value = rnorm(10),
category = sample(1:5, replace = TRUE, 100),
group = sample(c('A', 'B'), replace = TRUE, 10)) %>%
arrange(category)
d = tibble(value = rnorm(10),
category = sample(1:5, replace = TRUE, 10),
group = sample(c('A', 'B'), replace = TRUE, 10)) %>%
arrange(category)
d
tt <- dnds.L.ind %>%
group_by(strain) %>%
nest() %>%
spread(key = strain, value = data) %>%
mutate(
t_test = map2(NL, L, ~{t.test(.x$value, .y$value) %>% tidy()}),
A = map(A, nrow),
B = map(B, nrow)
) %>%
unnest()
tt <- dnds.L.ind %>%
group_by(strain, treat) %>%
nest() %>%
spread(key = strain, value = data) %>%
mutate(
t_test = map2("NL", "L", ~{t.test(.x$value, .y$value) %>% tidy()}),
A = map(A, nrow),
B = map(B, nrow)
) %>%
unnest()
tt <- dnds.L.ind %>%
group_by(strain, treat) %>%
nest() %>%
spread(key = strain, value = data) %>%
mutate(
t_test = map2(NL, L, ~{t.test(.x$value, .y$value) %>% tidy()}),
A = map(A, nrow),
B = map(B, nrow)
) %>%
unnest()
dnds.L.ind
tt<- dnds.L.ind  %>%
group_by(strain) %>%
summarise(res = list(t.test(dnds, mu=1)))
tt
dnds.L.ind  %>%
group_by(strain)
Location=rep(c("Area_A","Area_B"),4)
temp=rnorm(length(Location),34,5)
sample_data=data.frame(Location,temp)
sample_data
dt_res = sample_data %>%
group_by(Location)
dt_res
dt_res = sample_data %>%
group_by(Location) %>%                       # for each group
summarise(res = list(t.test(temp, mu=35)))
dt_res
dt_res$res
tt<- dnds.L.ind  %>%
group_by(strain) %>%
summarise(res = list(t.test(dnds, mu=1)))
tt$res
tt %>% dnds.L.ind  %>%
group_by(strain) %>%
summarise(res = list(tidy(t.test(dnds, mu=1)))) %>%
unnest()
tt <- dnds.L.ind  %>%
group_by(strain) %>%
summarise(res = list(tidy(t.test(dnds, mu=1)))) %>%
unnest()
tt <- dnds.L.ind  %>%
group_by(strain) %>%
summarise(res = list(tidy(t.test(dnds, mu=1)))) %>%
unnest_legacy()
tt
t.tests.NL <- dnds.NL.ind  %>%
group_by(strain) %>%
summarise(res = list(tidy(t.test(dnds, mu=1)))) %>%
unnest_legacy()
t.tests.NL
p.adjust(t.tests.NL$p.value)
bh.NL <- round(p.adjust(t.tests.NL$p.value, "BH"), 3)
bh.NL
bh.L <- round(p.adjust(t.tests.L$p.value, "BH"), 3)
t.tests.L <- dnds.L.ind  %>%
group_by(strain) %>%
summarise(res = list(tidy(t.test(dnds, mu=1)))) %>%
unnest_legacy()
bh.L <- round(p.adjust(t.tests.L$p.value, "BH"), 3)
bh.L
t.tests.L
t.tests.NL <- dnds.NL.ind  %>%
#group_by(strain) %>%
group_by(strain = fct_inorder(strain)) %>%
summarise(res = list(tidy(t.test(dnds, mu=1)))) %>%
unnest_legacy()
bh.NL <- round(p.adjust(t.tests.NL$p.value, "BH"), 3)
bh.NL
t.tests.NL
pcombo <- t.tests.NL[,c(1,4)]
pcombo
pcombo <- rbind(t.tests.NL[,c(1,4)],t.tests.L[,1,4)])
pcombo <- rbind(t.tests.NL[,c(1,4)],t.tests.L[,c(1,4)])
pcombo
pcombo <- round(p.adjust(pcombo$p.value, "BH"), 3)
pcombo <- rbind(t.tests.NL[,c(1,4)],t.tests.L[,c(1,4)])
bh <- round(p.adjust(pcombo$p.value, "BH"), 3)
treat.rep <- rep("NL",8)
treat.rep
treat.rep <- c(rep("NL",8), rep("L",8)
)
treat.rep
p <- rbind(t.tests.NL[,c(1,4)],t.tests.L[,c(1,4)])
bh <- round(p.adjust(pcombo$p.value, "BH"), 3)
treat.rep <- c(rep("NL",8), rep("L",8))
pcombo <- cbind(p, bh, treat.rep)
pcombo
pfilt <- filter(pcombo, p.value < 0.05)
pfilt
t.tests.L
p <- rbind(t.tests.NL[,c(1:2,4)],t.tests.L[,c(1:2,4)])
bh <- round(p.adjust(pcombo$p.value, "BH"), 3)
treat.rep <- c(rep("NL",8), rep("L",8))
pcombo <- cbind(p, bh, treat.rep)
pfilt <- filter(pcombo, p.value < 0.05)
pfilt
png(filename="~/GitHub/XevoLong/figures/Fig6.png",
width = 1200, height = 900, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(jitter(x.ind, amount = 0.5), dnds.NL.ind$dnds, xlim = c(0, 16),
ylim = c(-0.2, 2.5), type = "p", pch = 22, bg = "lightblue",
col = "lightblue", cex = 0.75, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n")
box(lwd = 2)
points(jitter(x.ind, amount = 0.5), dnds.L.ind$t.sum,
pch = 22, bg = "pink", col = "pink", lwd = 2, cex = 0.75)
# Add means
points(x, dnds.NL$mean, pch = 22,
bg = "blue", col = "blue", lwd = 1.25, cex = 2)
points(x, dnds.L$mean, pch = 22,
bg = "red", col = "red", lwd = 1.25, cex = 2)
# Add error bars
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean + dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.NL$mean,
y1 = dnds.NL$mean - dnds.NL$sem,
angle = 90, length = 0.1, lwd = 2, col = "blue")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean + dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
arrows(x0 = x, y0 = dnds.L$mean,
y1 = dnds.L$mean - dnds.L$sem,
angle = 90, length = 0.1, lwd = 2, col = "red")
# Add ticks
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at = c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(1, 3, 5, 7, 9, 11, 13, 15), labels = F)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("-1", "0", "1", "2"), at = c(-1, 0, 1, 2))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(-11, 0, 1, 2), labels = F)
# Add horizontal line
abline(h = 1, col= "darkgray", lty = 2, lwd = 2)
# Add axis labels
mtext(expression('Strains'), side = 1,
outer = TRUE, cex = 1.5, line = -2.5, adj = 0.5)
mtext(expression('dN/dS'), side = 2,
outer = TRUE, cex = 1.5, line = -4, adj = 0.55)
# Add legend
legend(0.1, 205, legend=c("no longevity", "longevity"),
col=c("blue", "red"), pt.bg = c("blue", "red"),
pch = c(22, 22), pt.cex = 1.5, cex = 0.75, bty = "n")
# Add strain labels
text(x=0.38, y=-0.9,"wild type",srt = 60, xpd = NA, cex = 1)
text(x=2.4, y= -0.8, expression(paste("rpl10a",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=4.4, y= -0.8, expression(paste("pmr1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=6.4, y= -0.8, expression(paste("sch9",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=8.4, y= -0.8, expression(paste("ypt6",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=10.4, y= -0.8, expression(paste("tor1",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=12.4, y= -0.8, expression(paste("tif2",Delta,)), srt = 60, xpd = NA, cex = 1)
text(x=14.4, y= -0.8, "LYS2", srt = 60, xpd = NA, cex = 1)
# Close plot device
dev.off()
graphics.off()
# Show plot
img <- readPNG("~/GitHub/XevoLong/figures/Fig6.png")
grid.raster(img)
pfilt
